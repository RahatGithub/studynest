{% if user.is_authenticated %}
    {% if is_enrolled %}
        <a href="{% url 'courses:learn_course' course.slug %}" class="btn btn-success w-100 mb-3">Continue Learning</a>
        <p class="text-muted small text-center">You are enrolled in this course</p>
    {% elif user.is_student %}
        {% if course.course_type == 'free' %}
            <form method="post" action="{% url 'courses:enroll_free_course' course.slug %}">
                {% csrf_token %}
                <button type="submit" class="btn btn-primary w-100">Enroll Now</button>
            </form>
        {% else %}
            <form method="post" action="#">
                {% csrf_token %}
                <button type="submit" class="btn btn-primary w-100">Enroll for ${{ course.price }}</button>
            </form>
        {% endif %}
    {% elif user.is_tutor %}
        {% if user == course.tutor %}
            <a href="#" class="btn btn-warning w-100 mb-2">Edit Course</a>
            <p class="text-muted small text-center">This is your course</p>
        {% else %}
            <p class="text-muted text-center">Tutors cannot enroll in courses</p>
        {% endif %}
    {% endif %}
{% else %}
    <a href="{% url 'accounts:login' %}" class="btn btn-primary w-100 mb-2">Login to Enroll</a>
    <p class="text-muted small text-center">
        New to StudyNest? 
        <a href="{% url 'accounts:signup_student' %}">Sign up</a>
    </p>
{% endif %}
